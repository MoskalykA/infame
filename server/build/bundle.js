var o={language:{type:1},identifier:{name:"discord"},character:{enabled:!0,maxCharactersEnabled:!1,maxCharacters:3,save:{position:!0,health:!0,armor:!0}},health:{default:200},armor:{default:0},model:{default:2488675799},weapons:{default:[1593441988,1649403952]},rank:{default:"user"},log:{enabled:!0,saveInDatabase:!0},ban:{enabled:!0},saveTime:6e4};var p=(r,e,n,t)=>{emitNet("infame.nets.notifications.notification",r,e,n,t)};var x={youAlreadyHaveCharacter:"You already have a character",yourCharacterCreatedWithSuccess:"Your character was created with success",characterLimit:"The character limit is $$, you cannot have a new character",newCharacter:"$$ has just created a character ($$$)",playerCharacter:"$$ has just chosen a character ($$$)",selectedCharacter:"You have successfully selected a character",invalidCharacter:"This character does not exist",reselectCharacter:"You will have to choose your character again",charactersSaved:"All the characters were saved",newPlayer:"$$ has just joined",playerDisconnected:"$$ has just disconnected",noOpenSession:"You do not have an open $$ so you are not able to join the server.",impossibleAction:"It is impossible to do this",infameGameModeReloaded:"The infame game mode was reloaded",unbannedBeCareful:"You have been unbanned, please be careful.",banDetails:"You were banned for $$ by $$$ and you will be unbanned on $$$$"};var Z={youAlreadyHaveCharacter:"Vous avez d\xE9j\xE0 un personnage",yourCharacterCreatedWithSuccess:"Votre personnage a \xE9t\xE9 cr\xE9\xE9 avec succ\xE8s",characterLimit:"La limite de personnages est de $$, vous ne pouvez pas en cr\xE9er un nouveau",newCharacter:"$$ vient de cr\xE9er un personnage ($$$)",playerCharacter:"$$ vient de choisir un personnage ($$$)",selectedCharacter:"Vous avez s\xE9lectionn\xE9 un personnage avec succ\xE8s",invalidCharacter:"Ce personnage n'existe pas",reselectCharacter:"Vous devrez choisir votre personnage \xE0 nouveau",charactersSaved:"Tous les personnages ont \xE9t\xE9 sauvegard\xE9s",newPlayer:"$$ vient de rejoindre",playerDisconnected:"$$ vient de se d\xE9connecter",noOpenSession:"Vous n'avez pas de session $$ ouverte, vous ne pouvez pas rejoindre le serveur.",impossibleAction:"Il est impossible de faire cela",infameGameModeReloaded:"Le mode de jeu inf\xE2me a \xE9t\xE9 recharg\xE9",unbannedBeCareful:"Vous avez \xE9t\xE9 d\xE9banni, veuillez faire attention.",banDetails:"Vous avez \xE9t\xE9 banni pour $$ par $$$, et vous serez d\xE9banni le $$$$"};var c=(r,e=[])=>{let n="$$",t=(o.language.type===0?x:Z)[r];return e.map(a=>{t=t.replace(n,a),n=n+"$"}),t};on("onResourceStop",r=>{GetCurrentResourceName()==r&&(GlobalState.infameAfterTheStop=!0)});on("onResourceStart",r=>{GetCurrentResourceName()==r&&setTimeout(()=>{GlobalState.infameAfterTheStop&&getPlayers().map(e=>{let n=Player(e);n.state.infameId=void 0,p(Number(e),0,c("infameGameModeReloaded"),5e3),o.character.enabled&&(n.state.characterId=void 0,p(Number(e),0,c("reselectCharacter"),5e3))})},1e3)});var q=require("mongodb"),ie="mongodb://127.0.0.1:27017",f=new q.MongoClient(ie);on("playerConnecting",(r,e,n)=>{n.defer();let t=getPlayerIdentifiers(source),a=t.findIndex(i=>i.startsWith(o.identifier.name));a>-1?o.ban.enabled?f.db("infame").collection("bans").findOne({discord:t[a].replace(`${o.identifier.name}:`,"")}).then(i=>{i===null?n.done():new Date().getTime()>=i.time?f.db("infame").collection("bans").deleteOne({discord:t[a].replace(`${o.identifier.name}:`,"")}).then(()=>{n.update(c("unbannedBeCareful")),setTimeout(()=>{n.done(),CancelEvent()},5e3)}):(n.done(c("banDetails",[i.reason,i.author,new Date(i.time).toLocaleString()])),CancelEvent())}):n.done():(n.done(c("noOpenSession",[o.identifier.name])),CancelEvent())});var Q=require("mongodb");var w=(r,e)=>{let n={},t=GetPlayerPed(r.toString());if(o.character.save.position){let[a,i,m]=GetEntityCoords(t);n.position={x:a,y:i,z:m}}o.character.save.health&&(n.health=GetEntityHealth(t)),o.character.save.armor&&(n.armor=GetPedArmour(t)),f.db("infame").collection("characters").updateOne({_id:Q.ObjectId.createFromHexString(e)},{$set:n})};o.character.enabled&&setInterval(()=>{getPlayers().map(r=>{let e=Player(r);e.state.infameId&&e.state.characterId&&w(Number(r),e.state.characterId),o.log.enabled&&u(c("charactersSaved"))})},o.saveTime);onNet("baseevents:onPlayerKilled",()=>{let r=source,e=Player(r);o.character.enabled&&e.state.characterId&&(e.state.characterId=void 0)});onNet("baseevents:onPlayerDied",()=>{let r=source,e=Player(r);o.character.enabled&&e.state.characterId&&(e.state.characterId=void 0)});onNet("baseevents:onPlayerWasted",()=>{let r=source,e=Player(r);o.character.enabled&&e.state.characterId&&(e.state.characterId=void 0)});var X=require("mongodb");var S=(r,e)=>{f.db("infame").collection("characters").findOne({_id:X.ObjectId.createFromHexString(e)}).then(n=>{if(n){o.log.enabled&&u(c("playerCharacter",[GetPlayerName(r.toString()),e])),p(r,0,c("selectedCharacter"),5e3);let t=Player(r);t.state.characterId=e,SetPlayerModel(r.toString(),n.model),setTimeout(()=>{emitNet("infame.nets.players.setData",r,n.health);let a=GetPlayerPed(r.toString());SetPedArmour(a,n.armor),SetEntityCoords(a,n.position.x,n.position.y,n.position.z,!0,!1,!1,!0),RemoveAllPedWeapons(a,!1),n.weapons.map(i=>{GiveWeaponToPed(a,i,100,!1,!1)})},500)}else p(r,1,c("invalidCharacter"),5e3),R(r)}).catch(()=>{p(r,1,c("impossibleAction"),5e3),R(r)})};onNet("infame.nets.characters.createCharacter",r=>{let e=source,n=Player(e);if(n.state.characterId){p(e,1,c("youAlreadyHaveCharacter"),5e3);return}f.db("infame").collection("characters").countDocuments({playerId:n.state.infameId}).then(t=>{o.character.maxCharactersEnabled&&t>=o.character.maxCharacters?p(e,1,c("characterLimit",[o.character.maxCharacters.toString()]),5e3):f.db("infame").collection("characters").insertOne({playerId:n.state.infameId,firstName:r.firstName,lastName:r.lastName,health:o.health.default,armor:o.armor.default,model:o.model.default,weapons:o.weapons.default,position:{x:0,y:0,z:0}}).then(a=>{o.log.enabled&&u(c("newCharacter",[GetPlayerName(source.toString()),a.insertedId.toHexString()])),S(e,a.insertedId.toHexString()),p(e,0,c("yourCharacterCreatedWithSuccess"),5e3)})})});onNet("infame.nets.characters.selectCharacter",r=>{let e=source;if(Player(e).state.characterId){p(e,1,c("youAlreadyHaveCharacter"),5e3);return}S(e,r)});var $=r=>{for(let e in r)e=="_id"&&r[e].toHexString?r[e]=r[e].toHexString():typeof r[e]=="object"&&(r[e]=$(r[e]));return r};var O=(r,e)=>{let n=Player(r);n.state.infameId=e,o.character.enabled?f.db("infame").collection("characters").find({playerId:e}).toArray().then(t=>{emitNet("infame.nets.characters.openMenu",r,{characters:$(t)})}):(SetPlayerModel(r.toString(),o.model.default),setTimeout(()=>{emitNet("infame.nets.players.setData",r,o.health.default);let t=GetPlayerPed(r.toString());SetPedArmour(t,o.armor.default),RemoveAllPedWeapons(t,!1),o.weapons.default.map(a=>{GiveWeaponToPed(t,a,100,!1,!1)})},500))},R=r=>{let e=getPlayerIdentifiers(r),n=e.findIndex(a=>a.startsWith(o.identifier.name)),t=e[n].replace(`${o.identifier.name}:`,"");f.db("infame").collection("users").updateOne({discord:t},{$setOnInsert:{rank:o.rank.default,discord:t}},{upsert:!0}).then(a=>{a.upsertedId!=null?O(r,a.upsertedId.toHexString()):f.db("infame").collection("users").findOne({discord:t}).then(i=>{i!=null&&i._id&&O(r,i._id.toHexString())})})};onNet("infame.nets.playerConnected",()=>{let r=source;o.log.enabled&&u(c("newPlayer",[GetPlayerName(r.toString())])),R(r)});var j=require("os"),M=require("path"),_=require("util");var Y={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]};function V(r,e,n,t=!1){let a=String(e),i=(d,s)=>`\x1B[${s[0]}m${d}\x1B[${s[1]}m`,m=(d,s)=>s!=null&&typeof s=="string"?i(d,Y[s]):s!=null&&Array.isArray(s)?s.reduce((h,l)=>m(h,l),d):s!=null&&s[d.trim()]!=null?m(d,s[d.trim()]):s!=null&&s["*"]!=null?m(d,s["*"]):d;return a.replace(/{{(.+?)}}/g,(d,s)=>{var l;let h=n[s]!=null?n[s]:t?"":d;return r.stylePrettyLogs?m(h,(l=r==null?void 0:r.prettyLogStyles)==null?void 0:l[s])+i("",Y.reset):h})}var oe={runtime:"Nodejs",runtimeVersion:process.version,hostname:(0,j.hostname)()};function ee(r,e,n,t,a,i){return Object.assign({},oe,{name:a,parentNames:i,date:new Date,logLevelId:r,logLevelName:e,path:t?void 0:se(n)})}function se(r,e=Error()){var n,t,a;return re((a=(t=(n=e==null?void 0:e.stack)==null?void 0:n.split(`
`))==null?void 0:t.filter(i=>i.includes("    at ")))==null?void 0:a[r])}function U(r){var e,n;return(n=(e=r==null?void 0:r.stack)==null?void 0:e.split(`
`))==null?void 0:n.reduce((t,a)=>(a.includes("    at ")&&t.push(re(a)),t),[])}function re(r){var n,t,a,i;let e={fullFilePath:void 0,fileName:void 0,fileNameWithLine:void 0,fileColumn:void 0,fileLine:void 0,filePath:void 0,filePathWithLine:void 0,method:void 0};if(r!=null&&r.includes("    at ")){r=r.replace(/^\s+at\s+/gm,"");let m=r.split(" ("),d=(r==null?void 0:r.slice(-1))===")"?(n=r==null?void 0:r.match(/\(([^)]+)\)/))==null?void 0:n[1]:r,s=d!=null&&d.includes(":")?(a=(t=d==null?void 0:d.replace("file://",""))==null?void 0:t.replace(process.cwd(),""))==null?void 0:a.split(":"):void 0,h=s==null?void 0:s.pop(),l=s==null?void 0:s.pop(),y=s==null?void 0:s.pop(),C=(0,M.normalize)(`${y}:${l}`),N=(i=y==null?void 0:y.split("/"))==null?void 0:i.pop(),L=`${N}:${l}`;y!=null&&y.length>0&&(e.fullFilePath=d,e.fileName=N,e.fileNameWithLine=L,e.fileColumn=h,e.fileLine=l,e.filePath=y,e.filePathWithLine=C,e.method=(m==null?void 0:m[1])!=null?m==null?void 0:m[0]:void 0)}return e}function K(r){var e;return((e=_.types)==null?void 0:e.isNativeError)!=null?_.types.isNativeError(r):r instanceof Error}function te(r,e){return r.reduce((n,t)=>(K(t)?n.errors.push(me(t,e)):n.args.push(t),n),{args:[],errors:[]})}function me(r,e){let n=U(r).map(a=>V(e,e.prettyErrorStackTemplate,{...a},!0)),t={errorName:` ${r.name} `,errorMessage:r.message,errorStack:n.join(`
`)};return V(e,e.prettyErrorTemplate,t)}function ne(r,e,n,t){let a=(n.length>0&&e.length>0?`
`:"")+n.join(`
`);t.prettyInspectOptions.colors=t.stylePrettyLogs,console.log(r+(0,_.formatWithOptions)(t.prettyInspectOptions,...e)+a)}function ae(r){console.log(e(r));function e(n){let t=new Set;return JSON.stringify(n,(a,i)=>{if(typeof i=="object"&&i!==null){if(t.has(i))return"[Circular]";t.add(i)}return i})}}function J(r){return Buffer.isBuffer(r)}function v(r,e=2,n=0){return r!=null&&isNaN(r)?"":(r=r!=null?r+n:r,e===2?r==null?"--":r<10?"0"+r:r.toString():r==null?"---":r<10?"00"+r:r<100?"0"+r:r.toString())}var z=class{constructor(e,n,t=4){var s,h,l,y,C,N,L;this.logObj=n,this.stackDepthLevel=t;let a=![typeof window,typeof document].includes("undefined"),i=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";this.runtime=a?"browser":i?"nodejs":"unknown";let m=a?(((window==null?void 0:window.chrome)||window.Intl&&(Intl==null?void 0:Intl.v8BreakIterator))&&"CSS"in window)!=null:!1,d=a?/^((?!chrome|android).)*safari/i.test(navigator==null?void 0:navigator.userAgent):!1;this.stackDepthLevel=d?4:this.stackDepthLevel,this.settings={type:(e==null?void 0:e.type)??"pretty",name:e==null?void 0:e.name,parentNames:e==null?void 0:e.parentNames,minLevel:(e==null?void 0:e.minLevel)??0,argumentsArrayName:e==null?void 0:e.argumentsArrayName,hideLogPositionForProduction:(e==null?void 0:e.hideLogPositionForProduction)??!1,prettyLogTemplate:(e==null?void 0:e.prettyLogTemplate)??"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}	{{logLevelName}}	{{filePathWithLine}}{{nameWithDelimiterPrefix}}	",prettyErrorTemplate:(e==null?void 0:e.prettyErrorTemplate)??`
{{errorName}} {{errorMessage}}
error stack:
{{errorStack}}`,prettyErrorStackTemplate:(e==null?void 0:e.prettyErrorStackTemplate)??`  \u2022 {{fileName}}	{{method}}
	{{filePathWithLine}}`,prettyErrorParentNamesSeparator:(e==null?void 0:e.prettyErrorParentNamesSeparator)??":",prettyErrorLoggerNameDelimiter:(e==null?void 0:e.prettyErrorLoggerNameDelimiter)??"	",stylePrettyLogs:(e==null?void 0:e.stylePrettyLogs)??!0,prettyLogTimeZone:(e==null?void 0:e.prettyLogTimeZone)??"UTC",prettyLogStyles:(e==null?void 0:e.prettyLogStyles)??{logLevelName:{"*":["bold","black","bgWhiteBright","dim"],SILLY:["bold","white"],TRACE:["bold","whiteBright"],DEBUG:["bold","green"],INFO:["bold","blue"],WARN:["bold","yellow"],ERROR:["bold","red"],FATAL:["bold","redBright"]},dateIsoStr:"white",filePathWithLine:"white",name:["white","bold"],nameWithDelimiterPrefix:["white","bold"],nameWithDelimiterSuffix:["white","bold"],errorName:["bold","bgRedBright","whiteBright"],fileName:["yellow"],fileNameWithLine:"white"},prettyInspectOptions:(e==null?void 0:e.prettyInspectOptions)??{colors:!0,compact:!1,depth:1/0},metaProperty:(e==null?void 0:e.metaProperty)??"_meta",maskPlaceholder:(e==null?void 0:e.maskPlaceholder)??"[***]",maskValuesOfKeys:(e==null?void 0:e.maskValuesOfKeys)??["password"],maskValuesOfKeysCaseInsensitive:(e==null?void 0:e.maskValuesOfKeysCaseInsensitive)??!1,maskValuesRegEx:e==null?void 0:e.maskValuesRegEx,prefix:[...(e==null?void 0:e.prefix)??[]],attachedTransports:[...(e==null?void 0:e.attachedTransports)??[]],overwrite:{mask:(s=e==null?void 0:e.overwrite)==null?void 0:s.mask,toLogObj:(h=e==null?void 0:e.overwrite)==null?void 0:h.toLogObj,addMeta:(l=e==null?void 0:e.overwrite)==null?void 0:l.addMeta,formatMeta:(y=e==null?void 0:e.overwrite)==null?void 0:y.formatMeta,formatLogObj:(C=e==null?void 0:e.overwrite)==null?void 0:C.formatLogObj,transportFormatted:(N=e==null?void 0:e.overwrite)==null?void 0:N.transportFormatted,transportJSON:(L=e==null?void 0:e.overwrite)==null?void 0:L.transportJSON}},this.settings.stylePrettyLogs=this.settings.stylePrettyLogs&&a&&!m?!1:this.settings.stylePrettyLogs}log(e,n,...t){var y,C,N,L,T,k,I,g,A,D,b,B,W,F;if(e<this.settings.minLevel)return;let a=[...this.settings.prefix,...t],i=((y=this.settings.overwrite)==null?void 0:y.mask)!=null?(C=this.settings.overwrite)==null?void 0:C.mask(a):this.settings.maskValuesOfKeys!=null&&this.settings.maskValuesOfKeys.length>0?this._mask(a):a,m=this.logObj!=null?this._recursiveCloneAndExecuteFunctions(this.logObj):void 0,d=((N=this.settings.overwrite)==null?void 0:N.toLogObj)!=null?(L=this.settings.overwrite)==null?void 0:L.toLogObj(i,m):this._toLogObj(i,m),s=((T=this.settings.overwrite)==null?void 0:T.addMeta)!=null?(k=this.settings.overwrite)==null?void 0:k.addMeta(d,e,n):this._addMetaToLogObj(d,e,n),h,l;return((I=this.settings.overwrite)==null?void 0:I.formatMeta)!=null&&(h=(g=this.settings.overwrite)==null?void 0:g.formatMeta(s==null?void 0:s[this.settings.metaProperty])),((A=this.settings.overwrite)==null?void 0:A.formatLogObj)!=null&&(l=(D=this.settings.overwrite)==null?void 0:D.formatLogObj(i,this.settings)),this.settings.type==="pretty"&&(h=h??this._prettyFormatLogObjMeta(s==null?void 0:s[this.settings.metaProperty]),l=l??te(i,this.settings)),h!=null&&l!=null?((b=this.settings.overwrite)==null?void 0:b.transportFormatted)!=null?(B=this.settings.overwrite)==null||B.transportFormatted(h,l.args,l.errors,this.settings):ne(h,l.args,l.errors,this.settings):((W=this.settings.overwrite)==null?void 0:W.transportJSON)!=null?(F=this.settings.overwrite)==null||F.transportJSON(s):this.settings.type!=="hidden"&&ae(s),this.settings.attachedTransports!=null&&this.settings.attachedTransports.length>0&&this.settings.attachedTransports.forEach(G=>{G(s)}),s}attachTransport(e){this.settings.attachedTransports.push(e)}getSubLogger(e,n){var i,m,d;let t={...this.settings,...e,parentNames:((i=this.settings)==null?void 0:i.parentNames)!=null&&((m=this.settings)==null?void 0:m.name)!=null?[...this.settings.parentNames,this.settings.name]:((d=this.settings)==null?void 0:d.name)!=null?[this.settings.name]:void 0,prefix:[...this.settings.prefix,...(e==null?void 0:e.prefix)??[]]};return new this.constructor(t,n??this.logObj,this.stackDepthLevel)}_mask(e){let n=this.settings.maskValuesOfKeysCaseInsensitive!==!0?this.settings.maskValuesOfKeys:this.settings.maskValuesOfKeys.map(t=>t.toLowerCase());return e==null?void 0:e.map(t=>this._recursiveCloneAndMaskValuesOfKeys(t,n))}_recursiveCloneAndMaskValuesOfKeys(e,n,t=[]){return t.includes(e)?{...e}:(typeof e=="object"&&e!=null&&t.push(e),J(e)?e:e instanceof Map?new Map(e):e instanceof Set?new Set(e):Array.isArray(e)?e.map(a=>this._recursiveCloneAndMaskValuesOfKeys(a,n,t)):e instanceof Date?new Date(e.getTime()):K(e)?Object.getOwnPropertyNames(e).reduce((a,i)=>{var m;return a[i]=n.includes(((m=this.settings)==null?void 0:m.maskValuesOfKeysCaseInsensitive)!==!0?i:i.toLowerCase())?this.settings.maskPlaceholder:this._recursiveCloneAndMaskValuesOfKeys(e[i],n,t),a},this._cloneError(e)):e!=null&&typeof e=="object"?Object.getOwnPropertyNames(e).reduce((a,i)=>{var m;return a[i]=n.includes(((m=this.settings)==null?void 0:m.maskValuesOfKeysCaseInsensitive)!==!0?i:i.toLowerCase())?this.settings.maskPlaceholder:this._recursiveCloneAndMaskValuesOfKeys(e[i],n,t),a},Object.create(Object.getPrototypeOf(e))):(a=>{var i,m;return(m=(i=this.settings)==null?void 0:i.maskValuesRegEx)==null||m.forEach(d=>{var s;a=(s=a==null?void 0:a.toString())==null?void 0:s.replace(d,this.settings.maskPlaceholder)}),a})(e))}_recursiveCloneAndExecuteFunctions(e,n=[]){return n.includes(e)?{...e}:(typeof e=="object"&&n.push(e),Array.isArray(e)?e.map(t=>this._recursiveCloneAndExecuteFunctions(t,n)):e instanceof Date?new Date(e.getTime()):e&&typeof e=="object"?Object.getOwnPropertyNames(e).reduce((t,a)=>(Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a)),t[a]=typeof e[a]=="function"?e[a]():this._recursiveCloneAndExecuteFunctions(e[a],n),t),Object.create(Object.getPrototypeOf(e))):e)}_toLogObj(e,n={}){return e=e==null?void 0:e.map(t=>K(t)?this._toErrorObject(t):t),this.settings.argumentsArrayName==null?e.length===1&&!Array.isArray(e[0])&&J(e[0])!==!0&&!(e[0]instanceof Date)?n=typeof e[0]=="object"&&e[0]!=null?{...e[0],...n}:{0:e[0],...n}:n={...n,...e}:n={...n,[this.settings.argumentsArrayName]:e},n}_cloneError(e){let n=e.constructor,t=new n(e.message);Object.assign(t,e);let a=Object.getOwnPropertyNames(t);for(let i of a){let m=Object.getOwnPropertyDescriptor(t,i);m&&(m.writable=!0,Object.defineProperty(t,i,m))}return t}_toErrorObject(e){return{nativeError:e,name:e.name??"Error",message:e.message,stack:U(e)}}_addMetaToLogObj(e,n,t){return{...e,[this.settings.metaProperty]:ee(n,t,this.stackDepthLevel,this.settings.hideLogPositionForProduction,this.settings.name,this.settings.parentNames)}}_prettyFormatLogObjMeta(e){var m,d,s,h,l,y,C,N,L,T,k,I,g,A,D,b,B,W,F,G;if(e==null)return"";let n=this.settings.prettyLogTemplate,t={};n.includes("{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}")?n=n.replace("{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}","{{dateIsoStr}}"):this.settings.prettyLogTimeZone==="UTC"?(t.yyyy=((m=e==null?void 0:e.date)==null?void 0:m.getUTCFullYear())??"----",t.mm=v((d=e==null?void 0:e.date)==null?void 0:d.getUTCMonth(),2,1),t.dd=v((s=e==null?void 0:e.date)==null?void 0:s.getUTCDate(),2),t.hh=v((h=e==null?void 0:e.date)==null?void 0:h.getUTCHours(),2),t.MM=v((l=e==null?void 0:e.date)==null?void 0:l.getUTCMinutes(),2),t.ss=v((y=e==null?void 0:e.date)==null?void 0:y.getUTCSeconds(),2),t.ms=v((C=e==null?void 0:e.date)==null?void 0:C.getUTCMilliseconds(),3)):(t.yyyy=((N=e==null?void 0:e.date)==null?void 0:N.getFullYear())??"----",t.mm=v((L=e==null?void 0:e.date)==null?void 0:L.getMonth(),2,1),t.dd=v((T=e==null?void 0:e.date)==null?void 0:T.getDate(),2),t.hh=v((k=e==null?void 0:e.date)==null?void 0:k.getHours(),2),t.MM=v((I=e==null?void 0:e.date)==null?void 0:I.getMinutes(),2),t.ss=v((g=e==null?void 0:e.date)==null?void 0:g.getSeconds(),2),t.ms=v((A=e==null?void 0:e.date)==null?void 0:A.getMilliseconds(),3));let a=this.settings.prettyLogTimeZone==="UTC"?e==null?void 0:e.date:new Date(((D=e==null?void 0:e.date)==null?void 0:D.getTime())-((b=e==null?void 0:e.date)==null?void 0:b.getTimezoneOffset())*6e4);t.rawIsoStr=a==null?void 0:a.toISOString(),t.dateIsoStr=a==null?void 0:a.toISOString().replace("T"," ").replace("Z",""),t.logLevelName=e==null?void 0:e.logLevelName,t.fileNameWithLine=((B=e==null?void 0:e.path)==null?void 0:B.fileNameWithLine)??"",t.filePathWithLine=((W=e==null?void 0:e.path)==null?void 0:W.filePathWithLine)??"",t.fullFilePath=((F=e==null?void 0:e.path)==null?void 0:F.fullFilePath)??"";let i=(G=this.settings.parentNames)==null?void 0:G.join(this.settings.prettyErrorParentNamesSeparator);return i=i!=null&&(e==null?void 0:e.name)!=null?i+this.settings.prettyErrorParentNamesSeparator:void 0,t.name=(e==null?void 0:e.name)!=null||i!=null?(i??"")+(e==null?void 0:e.name):"",t.nameWithDelimiterPrefix=t.name.length>0?this.settings.prettyErrorLoggerNameDelimiter+t.name:"",t.nameWithDelimiterSuffix=t.name.length>0?t.name+this.settings.prettyErrorLoggerNameDelimiter:"",V(this.settings,n,t)}};var H=class extends z{constructor(e,n){super(e,n,5)}log(e,n,...t){return super.log(e,n,...t)}silly(...e){return super.log(0,"SILLY",...e)}trace(...e){return super.log(1,"TRACE",...e)}debug(...e){return super.log(2,"DEBUG",...e)}info(...e){return super.log(3,"INFO",...e)}warn(...e){return super.log(4,"WARN",...e)}error(...e){return super.log(5,"ERROR",...e)}fatal(...e){return super.log(6,"FATAL",...e)}getSubLogger(e,n){return super.getSubLogger(e,n)}};var ce=new H({hideLogPositionForProduction:!0}),u=(...r)=>{o.log.saveInDatabase&&f.db("infame").collection("logs").insertOne({content:r.length===1?r[0]:JSON.stringify(r),time:new Date().getTime()}),ce.info(...r)};on("playerDropped",()=>{let r=source;o.log.enabled&&u(c("playerDisconnected",[GetPlayerName(r.toString())]));let e=Player(r);e.state.characterId&&w(r,e.state.characterId)});
